<!DOCTYPE html>
<html lang="th">
<head>
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="icon.png">
    <meta name="theme-color" content="#000000">
    ```
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏™.‡∏î‡∏û.‡∏ö‡∏≤‡∏á‡∏ö‡∏≠‡∏ô V2.3.1 (Official)</title>
    <style>
        body { font-family: 'Segoe UI', Tahoma, sans-serif; background-color: #1a1a1a; color: #e0e0e0; padding: 10px; margin: 0; }
        header { text-align: center; background: #b71c1c; color: white; padding: 15px; border-radius: 0 0 15px 15px; margin-bottom: 20px; box-shadow: 0 4px 10px rgba(0,0,0,0.5); }
        .container { max-width: 600px; margin: auto; }
        .form-group { background: #2d2d2d; padding: 15px; border-radius: 12px; margin-bottom: 20px; box-shadow: 0 4px 15px rgba(0,0,0,0.3); border: 1px solid #444; }
        .group-fire { border-top: 5px solid #ff5252; }
        .group-rescue { border-top: 5px solid #ffd740; }
        h3 { margin-top: 0; color: #fff; border-bottom: 1px solid #444; padding-bottom: 10px; }
        label { display: block; margin-top: 12px; font-weight: bold; font-size: 0.9em; color: #bbb; }
        input, select, textarea { width: 100%; padding: 10px; margin-top: 5px; background-color: #3d3d3d; border: 1px solid #555; border-radius: 6px; color: #fff; box-sizing: border-box; font-size: 16px; }
        input[readonly], textarea[readonly] { cursor: pointer; background-color: #333; }
        .car-grid, .time-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .btn-submit { width: 100%; padding: 15px; margin-top: 20px; border: none; border-radius: 8px; color: white; font-weight: bold; cursor: pointer; font-size: 1.1em; transition: 0.3s; }
        .btn-red { background: #d32f2f; box-shadow: 0 4px 0 #891a1a; }
        .btn-yellow { background: #fbc02d; color: #000; box-shadow: 0 4px 0 #c49000; }
        #output-section { margin-top: 20px; display: none; }
        #output { background: #000; color: #00ff41; padding: 15px; border: 1px dashed #4caf50; border-radius: 8px; white-space: pre-wrap; font-family: 'Courier New', monospace; font-size: 0.9em; }
        .overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.85); display: none; justify-content: center; align-items: center; z-index: 1000; }
        .editor-container { background: #2d2d2d; padding: 20px; border-radius: 15px; width: 90%; max-width: 450px; border: 1px solid #555; }
        .editor-footer { display: flex; justify-content: flex-end; gap: 10px; margin-top: 15px; }
        .btn-cancel { background: #555; color: white; border: none; padding: 10px 20px; border-radius: 5px; }
        .btn-save { background: #2e7d32; color: white; border: none; padding: 10px 20px; border-radius: 5px; }
        .copy-hint { display: none; position: fixed; top: 20px; left: 50%; transform: translateX(-50%); background: #4caf50; color: white; padding: 10px 25px; border-radius: 30px; font-weight: bold; z-index: 2000; }
    </style>
</head>
<body>

<header>
    <h2>üöí ‡∏™.‡∏î‡∏û.‡∏ö‡∏≤‡∏á‡∏ö‡∏≠‡∏ô (V2.3.1)</h2>
</header>

<div class="container">
    <div class="form-group group-fire">
        <h3>üî• ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡πÄ‡∏´‡∏ï‡∏∏‡πÄ‡∏û‡∏•‡∏¥‡∏á‡πÑ‡∏´‡∏°‡πâ</h3>
        <label>üìç ‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏¥‡∏î‡πÄ‡∏´‡∏ï‡∏∏ / ‡∏û‡∏¥‡∏Å‡∏±‡∏î</label>
        <input type="text" id="fire_place" placeholder="‡πÅ‡∏ï‡∏∞‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏û‡∏¥‡∏°‡∏û‡πå‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà..." readonly onclick="openEditor('fire_place', 'üìç ‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏¥‡∏î‡πÄ‡∏´‡∏ï‡∏∏')">
        
        <label>üöí ‡∏£‡∏ñ‡∏ó‡∏µ‡πà‡∏≠‡∏≠‡∏Å‡πÄ‡∏´‡∏ï‡∏∏</label>
        <div class="car-grid">
            <select id="fire_car1"><option value="">-- ‡∏£‡∏ñ 1 --</option><option value="‡∏ö‡∏≤‡∏á‡∏ö‡∏≠‡∏ô 061-1">‡∏ö‡∏≤‡∏á‡∏ö‡∏≠‡∏ô 061-1</option><option value="‡∏ö‡∏≤‡∏á‡∏ö‡∏≠‡∏ô 062-1">‡∏ö‡∏≤‡∏á‡∏ö‡∏≠‡∏ô 062-1</option><option value="‡∏ö‡∏≤‡∏á‡∏ö‡∏≠‡∏ô 041-1">‡∏ö‡∏≤‡∏á‡∏ö‡∏≠‡∏ô 041-1</option><option value="‡∏ö‡∏≤‡∏á‡∏ö‡∏≠‡∏ô 051-1">‡∏ö‡∏≤‡∏á‡∏ö‡∏≠‡∏ô 051-1</option><option value="‡∏ö‡∏≤‡∏á‡∏ö‡∏≠‡∏ô 052-1">‡∏ö‡∏≤‡∏á‡∏ö‡∏≠‡∏ô 052-1</option><option value="‡∏ö‡∏≤‡∏á‡∏ö‡∏≠‡∏ô 052-2">‡∏ö‡∏≤‡∏á‡∏ö‡∏≠‡∏ô 052-2</option><option value="‡∏ö‡∏≤‡∏á‡∏ö‡∏≠‡∏ô 053-1">‡∏ö‡∏≤‡∏á‡∏ö‡∏≠‡∏ô 053-1</option></select>
            <select id="fire_car2"><option value="">-- ‡∏£‡∏ñ 2 --</option><option value="‡∏ö‡∏≤‡∏á‡∏ö‡∏≠‡∏ô 061-1">‡∏ö‡∏≤‡∏á‡∏ö‡∏≠‡∏ô 061-1</option><option value="‡∏ö‡∏≤‡∏á‡∏ö‡∏≠‡∏ô 062-1">‡∏ö‡∏≤‡∏á‡∏ö‡∏≠‡∏ô 062-1</option><option value="‡∏ö‡∏≤‡∏á‡∏ö‡∏≠‡∏ô 041-1">‡∏ö‡∏≤‡∏á‡∏ö‡∏≠‡∏ô 041-1</option><option value="‡∏ö‡∏≤‡∏á‡∏ö‡∏≠‡∏ô 051-1">‡∏ö‡∏≤‡∏á‡∏ö‡∏≠‡∏ô 051-1</option><option value="‡∏ö‡∏≤‡∏á‡∏ö‡∏≠‡∏ô 052-1">‡∏ö‡∏≤‡∏á‡∏ö‡∏≠‡∏ô 052-1</option><option value="‡∏ö‡∏≤‡∏á‡∏ö‡∏≠‡∏ô 052-2">‡∏ö‡∏≤‡∏á‡∏ö‡∏≠‡∏ô 052-2</option><option value="‡∏ö‡∏≤‡∏á‡∏ö‡∏≠‡∏ô 053-1">‡∏ö‡∏≤‡∏á‡∏ö‡∏≠‡∏ô 053-1</option></select>
            <select id="fire_car3"><option value="">-- ‡∏£‡∏ñ 3 --</option><option value="‡∏ö‡∏≤‡∏á‡∏ö‡∏≠‡∏ô 061-1">‡∏ö‡∏≤‡∏á‡∏ö‡∏≠‡∏ô 061-1</option><option value="‡∏ö‡∏≤‡∏á‡∏ö‡∏≠‡∏ô 062-1">‡∏ö‡∏≤‡∏á‡∏ö‡∏≠‡∏ô 062-1</option><option value="‡∏ö‡∏≤‡∏á‡∏ö‡∏≠‡∏ô 041-1">‡∏ö‡∏≤‡∏á‡∏ö‡∏≠‡∏ô 041-1</option><option value="‡∏ö‡∏≤‡∏á‡∏ö‡∏≠‡∏ô 051-1">‡∏ö‡∏≤‡∏á‡∏ö‡∏≠‡∏ô 051-1</option><option value="‡∏ö‡∏≤‡∏á‡∏ö‡∏≠‡∏ô 052-1">‡∏ö‡∏≤‡∏á‡∏ö‡∏≠‡∏ô 052-1</option><option value="‡∏ö‡∏≤‡∏á‡∏ö‡∏≠‡∏ô 052-2">‡∏ö‡∏≤‡∏á‡∏ö‡∏≠‡∏ô 052-2</option><option value="‡∏ö‡∏≤‡∏á‡∏ö‡∏≠‡∏ô 053-1">‡∏ö‡∏≤‡∏á‡∏ö‡∏≠‡∏ô 053-1</option></select>
        </div>

        <div class="time-grid" style="grid-template-columns: 1fr 1fr 1fr; margin-top: 10px;">
            <div class="time-item"><label>‡∏£‡∏±‡∏ö‡πÅ‡∏à‡πâ‡∏á</label><input type="time" id="f_t1"></div>
            <div class="time-item"><label>‡πÅ‡∏à‡πâ‡∏á‡∏≠‡∏≠‡∏Å</label><input type="time" id="f_t2"></div>
            <div class="time-item"><label>‡∏ß.10</label><input type="time" id="f_t3"></div>
            <div class="time-item"><label>‡πÉ‡∏ä‡πâ‡∏ô‡πâ‡∏≥</label><input type="time" id="f_t4"></div>
            <div class="time-item"><label>‡πÄ‡∏•‡∏¥‡∏Å ‡∏ß.10</label><input type="time" id="f_t5"></div>
            <div class="time-item"><label>‡∏Å‡∏•‡∏±‡∏ö ‡∏™.‡∏î‡∏û.</label><input type="time" id="f_t6"></div>
        </div>
        
        <label>üë• ‡∏ú‡∏π‡πâ‡∏≠‡∏≠‡∏Å‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà</label>
        <textarea id="fire_team" rows="2" placeholder="‡πÅ‡∏ï‡∏∞‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠..." readonly onclick="openEditor('fire_team', 'üë• ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà')"></textarea>
        
        <label>üì¢ ‡∏ú‡∏π‡πâ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</label>
        <input type="text" id="fire_sender" placeholder="‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏Ç‡∏≤‡∏ô‡∏ú‡∏π‡πâ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô..." readonly onclick="openEditor('fire_sender', 'üì¢ ‡∏ú‡∏π‡πâ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô')">
        
        <button class="btn-submit btn-red" onclick="reportFire()">‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÅ‡∏•‡∏∞‡∏™‡πà‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡πÄ‡∏û‡∏•‡∏¥‡∏á‡πÑ‡∏´‡∏°‡πâ</button>
    </div>

    <div class="form-group group-rescue">
        <h3>üêæ ‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô</h3>
        
        <label>üêæ ‡∏ä‡∏ô‡∏¥‡∏î‡∏™‡∏±‡∏ï‡∏ß‡πå / ‡πÄ‡∏´‡∏ï‡∏∏‡∏ó‡∏µ‡πà‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏´‡∏•‡∏∑‡∏≠</label>
        <select id="res_type_text" onchange="toggleOtherInput()">
            <option value="‡∏á‡∏π‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏°">üêç ‡∏á‡∏π‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏°</option>
            <option value="‡∏á‡∏π‡πÄ‡∏´‡πà‡∏≤">üêç ‡∏á‡∏π‡πÄ‡∏´‡πà‡∏≤</option>
            <option value="‡∏á‡∏π‡∏ó‡∏≤‡∏á‡∏°‡∏∞‡∏û‡∏£‡πâ‡∏≤‡∏ß">üêç ‡∏á‡∏π‡∏ó‡∏≤‡∏á‡∏°‡∏∞‡∏û‡∏£‡πâ‡∏≤‡∏ß</option>
            <option value="‡∏ï‡∏±‡∏ß‡πÄ‡∏á‡∏¥‡∏ô‡∏ï‡∏±‡∏ß‡∏ó‡∏≠‡∏á">ü¶é ‡∏ï‡∏±‡∏ß‡πÄ‡∏á‡∏¥‡∏ô‡∏ï‡∏±‡∏ß‡∏ó‡∏≠‡∏á</option>
            <option value="‡∏Å‡∏≥‡∏à‡∏±‡∏î‡∏£‡∏±‡∏á‡∏ï‡πà‡∏≠">üêù ‡∏Å‡∏≥‡∏à‡∏±‡∏î‡∏£‡∏±‡∏á‡∏ï‡πà‡∏≠</option>
            <option value="‡∏Å‡∏≥‡∏à‡∏±‡∏î‡∏£‡∏±‡∏á‡πÅ‡∏ï‡∏ô">üêù ‡∏Å‡∏≥‡∏à‡∏±‡∏î‡∏£‡∏±‡∏á‡πÅ‡∏ï‡∏ô</option>
            <option value="‡∏Å‡∏≥‡∏à‡∏±‡∏î‡∏£‡∏±‡∏á‡∏ú‡∏∂‡πâ‡∏á">üêù ‡∏Å‡∏≥‡∏à‡∏±‡∏î‡∏£‡∏±‡∏á‡∏ú‡∏∂‡πâ‡∏á</option>
            <option value="‡∏Å‡∏≥‡∏à‡∏±‡∏î‡∏£‡∏±‡∏á‡∏°‡∏î">üêù ‡∏Å‡∏≥‡∏à‡∏±‡∏î‡∏£‡∏±‡∏á‡∏°‡∏î</option>
            <option value="‡πÄ‡∏´‡∏ï‡∏∏‡∏≠‡∏∑‡πà‡∏ô‡πÜ">üõ†Ô∏è ‡πÄ‡∏´‡∏ï‡∏∏‡∏≠‡∏∑‡πà‡∏ô‡πÜ (‡∏£‡∏∞‡∏ö‡∏∏‡πÄ‡∏û‡∏¥‡πà‡∏°)</option>
        </select>

        <input type="text" id="res_type_other" placeholder="‡πÇ‡∏õ‡∏£‡∏î‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°..." 
               style="display:none; margin-top:10px;" 
               readonly onclick="openEditor('res_type_other', 'üõ†Ô∏è ‡∏£‡∏∞‡∏ö‡∏∏‡πÄ‡∏´‡∏ï‡∏∏‡∏≠‡∏∑‡πà‡∏ô‡πÜ')">

        <label>üìè ‡∏Ç‡∏ô‡∏≤‡∏î/‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</label>
        <input type="text" id="res_len_text" placeholder="‡πÄ‡∏ä‡πà‡∏ô 2 ‡πÄ‡∏°‡∏ï‡∏£ / 1 ‡∏ï‡∏±‡∏ß" readonly onclick="openEditor('res_len_text', 'üìè ‡∏Ç‡∏ô‡∏≤‡∏î')">
        
        <label>üìç ‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà / ‡∏û‡∏¥‡∏Å‡∏±‡∏î</label>
        <input type="text" id="res_place" placeholder="‡∏ö‡πâ‡∏≤‡∏ô‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà / ‡∏ã‡∏≠‡∏¢ / ‡∏ñ‡∏ô‡∏ô..." readonly onclick="openEditor('res_place', 'üìç ‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏¥‡∏î‡πÄ‡∏´‡∏ï‡∏∏')">
        
        <label>üöí ‡∏£‡∏ñ‡∏ó‡∏µ‡πà‡∏≠‡∏≠‡∏Å‡πÄ‡∏´‡∏ï‡∏∏</label>
        <select id="res_car_single"><option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡∏±‡∏ô‡∏£‡∏ñ --</option><option value="‡∏ö‡∏≤‡∏á‡∏ö‡∏≠‡∏ô 061-1">‡∏ö‡∏≤‡∏á‡∏ö‡∏≠‡∏ô 061-1</option><option value="‡∏ö‡∏≤‡∏á‡∏ö‡∏≠‡∏ô 062-1">‡∏ö‡∏≤‡∏á‡∏ö‡∏≠‡∏ô 062-1</option><option value="‡∏ö‡∏≤‡∏á‡∏ö‡∏≠‡∏ô 041-1">‡∏ö‡∏≤‡∏á‡∏ö‡∏≠‡∏ô 041-1</option><option value="‡∏ö‡∏≤‡∏á‡∏ö‡∏≠‡∏ô 051-1">‡∏ö‡∏≤‡∏á‡∏ö‡∏≠‡∏ô 051-1</option><option value="‡∏ö‡∏≤‡∏á‡∏ö‡∏≠‡∏ô 052-1">‡∏ö‡∏≤‡∏á‡∏ö‡∏≠‡∏ô 052-1</option></select>

        <div class="time-grid" style="margin-top: 10px;">
            <div class="time-item"><label>‡∏£‡∏±‡∏ö‡πÅ‡∏à‡πâ‡∏á</label><input type="time" id="r_t1"></div>
            <div class="time-item"><label>‡πÅ‡∏à‡πâ‡∏á‡∏≠‡∏≠‡∏Å</label><input type="time" id="r_t2"></div>
            <div class="time-item"><label>‡∏ß.10</label><input type="time" id="r_t3"></div>
            <div class="time-item"><label>‡πÄ‡∏•‡∏¥‡∏Å ‡∏ß.10</label><input type="time" id="r_t4"></div>
            <div class="time-item"><label>‡∏ß.4 ‡∏™.‡∏î‡∏û.</label><input type="time" id="r_t5"></div>
        </div>

        <label>üë• ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà</label>
        <textarea id="res_team" rows="2" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà..." readonly onclick="openEditor('res_team', 'üë• ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà')"></textarea>
        
        <label>üì¢ ‡∏ú‡∏π‡πâ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</label>
        <input type="text" id="res_sender" placeholder="‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏Ç‡∏≤‡∏ô‡∏ú‡∏π‡πâ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô..." readonly onclick="openEditor('res_sender', 'üì¢ ‡∏ú‡∏π‡πâ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô')">
        
        <button class="btn-submit btn-yellow" onclick="reportRescue()">‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÅ‡∏•‡∏∞‡∏™‡πà‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏´‡∏•‡∏∑‡∏≠</button>
    </div>

    <div id="output-section">
        <div id="output"></div>
    </div>
</div>

<div id="copyHint" class="copy-hint">‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏•‡∏á Clipboard ‡πÅ‡∏•‡∏∞‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢!</div>

<div id="editorOverlay" class="overlay">
    <div class="editor-container">
        <h4 id="editor-title" style="margin-top:0">üìù ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</h4>
        <textarea id="expanded-text" rows="8" style="width:100%; background:#1a1a1a; color:white; border:1px solid #555; padding:10px; border-radius:8px;"></textarea>
        <div class="editor-footer">
            <button class="btn-cancel" onclick="closeEditor(false)">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
            <button class="btn-save" onclick="closeEditor(true)">‡∏ï‡∏Å‡∏•‡∏á</button>
        </div>
    </div>
</div>

<script>
    let currentTargetId = ''; 
    const GOOGLE_SCRIPT_URL = "https://script.google.com/macros/s/AKfycbwPzifoIBEyuVyTMvNEZ4v2Gf_nGaFhYjyrjf4PDgvL7EYiZhpNXi5Rec8jwLmmg8nMMQ/exec";

    function getThaiDate() {
        const now = new Date();
        const months = ["‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏°", "‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå", "‡∏°‡∏µ‡∏ô‡∏≤‡∏Ñ‡∏°", "‡πÄ‡∏°‡∏©‡∏≤‡∏¢‡∏ô", "‡∏û‡∏§‡∏©‡∏†‡∏≤‡∏Ñ‡∏°", "‡∏°‡∏¥‡∏ñ‡∏∏‡∏ô‡∏≤‡∏¢‡∏ô", "‡∏Å‡∏£‡∏Å‡∏é‡∏≤‡∏Ñ‡∏°", "‡∏™‡∏¥‡∏á‡∏´‡∏≤‡∏Ñ‡∏°", "‡∏Å‡∏±‡∏ô‡∏¢‡∏≤‡∏¢‡∏ô", "‡∏ï‡∏∏‡∏•‡∏≤‡∏Ñ‡∏°", "‡∏û‡∏§‡∏®‡∏à‡∏¥‡∏Å‡∏≤‡∏¢‡∏ô", "‡∏ò‡∏±‡∏ô‡∏ß‡∏≤‡∏Ñ‡∏°"];
        return `‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà ${now.getDate()} ${months[now.getMonth()]} ${now.getFullYear() + 543}`;
    }

    // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏õ‡∏¥‡∏î/‡∏õ‡∏¥‡∏î‡∏ä‡πà‡∏≠‡∏á‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏´‡∏ï‡∏∏‡∏≠‡∏∑‡πà‡∏ô‡πÜ
    function toggleOtherInput() {
        const select = document.getElementById('res_type_text');
        const otherInput = document.getElementById('res_type_other');
        otherInput.style.display = (select.value === '‡πÄ‡∏´‡∏ï‡∏∏‡∏≠‡∏∑‡πà‡∏ô‡πÜ') ? 'block' : 'none';
    }

    function openEditor(id, title) {
        currentTargetId = id;
        document.getElementById('editor-title').innerText = title;
        document.getElementById('expanded-text').value = document.getElementById(id).value;
        document.getElementById('editorOverlay').style.display = 'flex';
        setTimeout(() => { document.getElementById('expanded-text').focus(); }, 150);
    }

    function closeEditor(isSave) {
        if (isSave) document.getElementById(currentTargetId).value = document.getElementById('expanded-text').value;
        document.getElementById('editorOverlay').style.display = 'none';
    }

    async function processAndSend(text, jsonData) {
        const outSection = document.getElementById('output-section');
        const outDisplay = document.getElementById('output');
        outDisplay.innerText = text;
        outSection.style.display = 'block';
        outSection.scrollIntoView({ behavior: 'smooth' });

        try {
            await navigator.clipboard.writeText(text);
            const hint = document.getElementById('copyHint');
            hint.style.display = 'block';
            setTimeout(() => { hint.style.display = 'none'; }, 2500);
        } catch (err) {
            const textArea = document.createElement("textarea");
            textArea.value = text; document.body.appendChild(textArea);
            textArea.select(); document.execCommand('copy');
            document.body.removeChild(textArea);
        }

        if (GOOGLE_SCRIPT_URL !== "") {
            fetch(GOOGLE_SCRIPT_URL, { 
                method: 'POST', 
                mode: 'no-cors', 
                headers: { 'Content-Type': 'text/plain' },
                body: JSON.stringify(jsonData) 
            });
        }
    }

   function reportFire() {
    let cars = [
        document.getElementById('fire_car1').value, 
        document.getElementById('fire_car2').value, 
        document.getElementById('fire_car3').value
    ].filter(v => v);
    
    const carList = cars.join(', ') || '-'; // ‡∏£‡∏ß‡∏ö‡∏£‡∏ß‡∏°‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏£‡∏ñ
    const text = `${getThaiDate()}\n‡∏™.‡∏î‡∏û.‡∏ö‡∏≤‡∏á‡∏ö‡∏≠‡∏ô\nüî• ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡πÄ‡∏´‡∏ï‡∏∏‡πÄ‡∏û‡∏•‡∏¥‡∏á‡πÑ‡∏´‡∏°‡πâ\n‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà: ${document.getElementById('fire_place').value || '-'}\n‡∏£‡∏ñ‡∏ó‡∏µ‡πà‡∏≠‡∏≠‡∏Å‡πÄ‡∏´‡∏ï‡∏∏: ${carList}\n‡πÄ‡∏ß‡∏•‡∏≤‡∏£‡∏±‡∏ö‡πÅ‡∏à‡πâ‡∏á: ${document.getElementById('f_t1').value || '--:--'} ‡∏ô.\n‡πÄ‡∏ß‡∏•‡∏≤‡πÅ‡∏à‡πâ‡∏á‡∏≠‡∏≠‡∏Å: ${document.getElementById('f_t2').value || '--:--'} ‡∏ô.\n‡πÄ‡∏ß‡∏•‡∏≤ ‡∏ß.10: ${document.getElementById('f_t3').value || '--:--'} ‡∏ô.\n‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏ä‡πâ‡∏ô‡πâ‡∏≥: ${document.getElementById('f_t4').value || '--:--'} ‡∏ô.\n‡πÄ‡∏•‡∏¥‡∏Å ‡∏ß.10: ${document.getElementById('f_t5').value || '--:--'} ‡∏ô.\n‡∏ß.4 ‡∏™.‡∏î‡∏û.: ${document.getElementById('f_t6').value || '--:--'} ‡∏ô.\n‡∏ú‡∏π‡πâ‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥: ${document.getElementById('fire_team').value || '-'}\n‡∏ú‡∏π‡πâ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô: ${document.getElementById('fire_sender').value || '-'}`;
    
    processAndSend(text, { 
        type: "‡πÄ‡∏û‡∏•‡∏¥‡∏á‡πÑ‡∏´‡∏°‡πâ", 
        date: getThaiDate(),
        place: document.getElementById('fire_place').value || '-',
        staff: document.getElementById('fire_team').value || '-',
        sender: document.getElementById('fire_sender').value || '-',
        t1: document.getElementById('f_t1').value,
        t2: document.getElementById('f_t2').value,
        t3: document.getElementById('f_t3').value,
        t4: document.getElementById('f_t4').value,
        t5: document.getElementById('f_t6').value,
        car: carList // ‡∏™‡πà‡∏á‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏£‡∏ñ‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå L
    });
}
  function reportRescue() {
    let animalType = document.getElementById('res_type_text').value;
    if(animalType === '‡πÄ‡∏´‡∏ï‡∏∏‡∏≠‡∏∑‡πà‡∏ô‡πÜ') {
        animalType = document.getElementById('res_type_other').value || '‡πÄ‡∏´‡∏ï‡∏∏‡∏≠‡∏∑‡πà‡∏ô‡πÜ';
    }
    const carName = document.getElementById('res_car_single').value || '-';

    const text = `${getThaiDate()}\n‡∏™.‡∏î‡∏û.‡∏ö‡∏≤‡∏á‡∏ö‡∏≠‡∏ô\nüêæ ‡πÄ‡∏´‡∏ï‡∏∏‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô\n‡∏ä‡∏ô‡∏¥‡∏î: ${animalType}\n‡∏Ç‡∏ô‡∏≤‡∏î/‡∏à‡∏≥‡∏ô‡∏ß‡∏ô: ${document.getElementById('res_len_text').value || '-'}\n‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà: ${document.getElementById('res_place').value || '-'}\n‡∏£‡∏ñ‡∏ó‡∏µ‡πà‡∏≠‡∏≠‡∏Å‡πÄ‡∏´‡∏ï‡∏∏: ${carName}\n‡πÄ‡∏ß‡∏•‡∏≤‡∏£‡∏±‡∏ö‡πÅ‡∏à‡πâ‡∏á: ${document.getElementById('r_t1').value || '--:--'} ‡∏ô.\n‡πÄ‡∏ß‡∏•‡∏≤‡πÅ‡∏à‡πâ‡∏á‡∏≠‡∏≠‡∏Å: ${document.getElementById('r_t2').value || '--:--'} ‡∏ô.\n‡πÄ‡∏ß‡∏•‡∏≤ ‡∏ß.10: ${document.getElementById('r_t3').value || '--:--'} ‡∏ô.\n‡πÄ‡∏•‡∏¥‡∏Å ‡∏ß.10: ${document.getElementById('r_t4').value || '--:--'} ‡∏ô.\n‡∏ß.4 ‡∏™.‡∏î‡∏û.: ${document.getElementById('r_t5').value || '--:--'} ‡∏ô.\n‡∏ú‡∏π‡πâ‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥: ${document.getElementById('res_team').value || '-'}\n‡∏ú‡∏π‡πâ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô: ${document.getElementById('res_sender').value || '-'}`;
    
    processAndSend(text, { 
        type: `‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô (${animalType})`, 
        date: getThaiDate(),
        place: document.getElementById('res_place').value || '-',
        staff: document.getElementById('res_team').value || '-',
        sender: document.getElementById('res_sender').value || '-',
        t1: document.getElementById('r_t1').value,
        t2: document.getElementById('r_t2').value,
        t3: document.getElementById('r_t3').value,
        t4: document.getElementById('r_t4').value,
        t5: document.getElementById('r_t5').value,
        car: carName // ‡∏™‡πà‡∏á‡∏ä‡∏∑‡πà‡∏≠‡∏£‡∏ñ‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå L
    });
}
</script>

</body>
</html> 
